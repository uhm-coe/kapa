<% content_for(:box1) do %>

  <h4 class="section-header">
    <%=link_to "", {:action => :index}, :class => "glyphicon glyphicon-chevron-left" %>
    <%=h @practicum_school.name%>
  </h4>

  <div class="tabs">
    <ul class="nav nav-tabs">
      <li class="<%='active' if params[:focus] == 'school_profile' || params[:focus].nil? %>"><a href="#school_profile_tab" data-toggle="tab">Profile</a></li>
      <li class="<%='active' if params[:focus] == 'school_contact' %>"><a href="#school_contact_tab" data-toggle="tab">Contact</a></li>
      <li class="<%='active' if params[:focus] == 'mentors' %>"><a href="#mentors_tab" data-toggle="tab">Mentors</a></li>
      <li class="<%='active' if params[:focus] == 'placements' %>"><a href="#placements_tab" data-toggle="tab">Placements</a></li>
    </ul>

    <div class="tab-content">
      <div id="school_profile_tab" class="tab-pane<%=' active' if params[:focus] == 'school_profile' || params[:focus].nil? %>">
        <%=bootstrap_form_for :practicum_school, :url => practicum_school_path(:id => @practicum_school), :remote => true, :html => {:method => :put} do |f|%>
          <%=render :partial => "/practicum/school_form", :locals => {:f => f}%>
          <br/><%=controls if @current_user.manage?(:practicum, :delegate => :maintain)   %>
        <% end %>
      </div>

      <div id="school_contact_tab" class="tab-pane<%=' active' if params[:focus] == 'school_contact' %>">
        <%=bootstrap_form_for :practicum_school, :url => practicum_school_path(:id => @practicum_school, :focus => :school_contact), :remote => true, :html => {:method => :put}  do |f|%>
          <%=render :partial => "/practicum/school_contact_form" %>
          <br/><%=controls if @current_user.manage?(:practicum, :delegate => :maintain)   %>
        <% end %>
      </div>

      <div id="mentors_tab" class="tab-pane<%=' active' if params[:focus] == 'mentors' %>">
        <table class="table table-striped">
          <thead>
            <tr>
              <th>Name</th>
              <th>E-Mail</th>
              <th>Placements</th>
            </tr>
          </thead>
          <tbody>
            <% for mentor in @mentors %>
              <tr>
                <td><%=h mentor.full_name %></td>
                <td><%=mail_to mentor.contact.email if mentor.contact%></td>
                <td><%=h mentor.practicum_assignments.length.to_i %></td>
              </tr>
            <% end %>
          </tbody>
        </table>
      </div>

      <div id="placements_tab" class="tab-pane<%=' active' if params[:focus] == 'placements' %>">
        <table id="placement_list" class="table table-striped">
          <thead>
            <tr>
              <th>Semester</th>
              <th>ID</th>
              <th>Name</th>
              <th>Mentor</th>
              <th></th>
            </tr>
          </thead>
          <tbody>
            <% for practicum_assignment in @practicum_assignments %>
              <tr>
                <td><%=h practicum_assignment.practicum_placement.term_desc %></td>
                <td><%=practicum_assignment.practicum_placement.practicum_profile.person.id_number %></td>
                <td><%=abbr practicum_assignment.practicum_placement.practicum_profile.person.full_name%></td>
                <td><%=h practicum_assignment.person.full_name %></td>
                <td class="right"><%=link_to "Show", practicum_placement_path(:id => practicum_assignment.practicum_placement, :focus => :mentors) if practicum_assignment.practicum_placement.practicum_profile.coordinator?(@current_user) %></td>
              </tr>
            <% end %>
          </tbody>
        </table>
      </div>
    </div>
  </div>

<% end %>
