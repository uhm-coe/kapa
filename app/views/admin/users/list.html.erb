<% content_for(:head) do %>
  <script type="text/javascript">
    jQuery(document).ready(function($) {
      $('#open_dialog').click(function() {jQuery('#dialog').dialog('open');})
    });
  </script>
<% end %>


<% content_for(:box1) do %>
<h4>Users</h4>
  <%=form_tag :action => :list do %>
    <table>
    <tr class="bottom">
      <td>
      <p><label>Name or UID:<br>
      <%=text_field :filter, :key, :size => 20 %></label></p>
      </td>
      <td>
      <p><label>Department:<br>
      <%=history_select :filter, :department, :model_name => :user, :model_method => :department, :include_blank => true %></label></p>
      </td>
      <td>
      <p><label>Employment Status:<br>
      <%=select :filter, :emp_status, [["0/Non-Employee", "0"],["1/Former Employee" , "1"],["2/Active Employee" , "2"],["3/Overridden" , "3"]], {:include_blank => true} %></label></p>
      </td>
      <td>
      <p><label>User Status:<br>
      <%=select :filter, :status, [["0/No Access", "0"],["1/AS User" ,"1"],["3/SIS User" ,"3"]], {:include_blank => true}%></label></p>
      </td>
      <td>
      <%=submit_tag "Show" %>
      </td>
    </tr>
    </table>
  <%end%>
<%end%>

<% content_for(:box2) do %>

<table id="user_list">
  <tr>
    <th>User ID</th>
    <th>Name</th>
    <th>Auth Type</th>
    <th>ES</th>
    <th>US</th>
    <th>Department</th>
    <th>Data Access</th>
  </tr>

<% for user in @users %>
  <tr>
    <td><%=h user.uid %></td>
    <td><%=h user.person.full_name if user.person %></td>
    <td><%=h user.category %></td>
    <td><%=h user.emp_status %></td>
    <td><%=h user.status %></td>
    <td><%=h user.department %></td>
    <td><%=h user.dept %></td>
    <td><%=link_to "Show", :action => "show", :id => user %></td>
  </tr>
<% end %>
</table>
  <br>
  <div class="center"><%=will_paginate @users %></div>

<p class="right">  
  <%=link_to "New", :action => :new %>
  <%=link_to_function "Import", nil, :id => "open_dialog" if @current_user.manage? :admin, :delegate => :import %>
  <%=link_to "Export", :action => :export%>
</p>

<div id="dialog" class="form-dialog" title="Import User Data">
  <%=label_form_for(:filter, :url => admin_users_path(:action => :import), :html => {:multipart => true, :id => "import_user_form"} ) do |f| %>
     <%=f.file_field :import_file %>
  <% end %>
</div>


<% end %>
