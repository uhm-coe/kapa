<% if form_template.type == "complex" %>
  <%= render :partial => form_template.template_path, :locals => {:context => :kapa} %>
<% else %>
  <%= bootstrap_fields_for :form_ext do |f| %>
    <% form_template.form_template_fields.each do |form_template_field| %>
       
      <%= 
        options = {} 
        options[:hint] = form_template_field.hint if form_template_field.hint.present?      
        options[:tip] = form_template_field.tip if form_template_field.tip.present?
        options[:required] = form_template_field.required if form_template_field.required.present?      
        options[:include_blank] = form_template_field.include_blank if form_template_field.include_blank.present?      

        if form_template_field.type == "section" 
          content_tag(:legend, form_template_field.label, options)
        elsif form_template_field.type == "text_area"
          options[:rows] = 10
          f.text_area(form_template_field.label, options)
        elsif form_template_field.type == "select"
          f.select(form_template_field.label, form_template_field.type_option.to_s.split(/,\s*/), options)
        elsif form_template_field.type =~ /_select$/ 
          options[:name] = form_template_field.type_option 
          f.send(form_template_field.type, [form_template_field.label, options])
        else
          f.send(form_template_field.type, [form_template_field.label, options])
        end
      %>
    <% end %>
  <% end %>
<% end %>
<%= hidden_field :form, :person_id %>
<%= hidden_field :form, :type %>
